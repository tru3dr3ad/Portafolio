CREATE OR REPLACE TRIGGER descontar_productos
     AFTER INSERT ON DETALLE_BOLETA FOR EACH ROW
DECLARE
BEGIN 
    UPDATE PRODUCTO
    SET STOCK = STOCK - :NEW.CANTIDAD
    WHERE CODIGO = :NEW.PRODUCTO_CODIGO;
    
END;


-----------ELIMINA VENTA Y ELIMINA DETALLE COMPRA------------------------
-------------------------
CREATE OR REPLACE TRIGGER elimina_venta
     AFTER DELETE ON BOLETA FOR EACH ROW
DECLARE
BEGIN 
    DELETE DETALLE_BOLETA 
    WHERE BOLETA_NUMEROBOLETA = :OLD.NUMEROBOLETA;
    
END;
--------Trigger POST-VENTA que descuente productos ELIMINA
CREATE OR REPLACE TRIGGER actualiza_elimina_venta
     AFTER DELETE ON DETALLE_BOLETA FOR EACH ROW
DECLARE
BEGIN 
    UPDATE PRODUCTO
    SET STOCK = STOCK + :OLD.CANTIDAD
    WHERE CODIGO = :OLD.PRODUCTO_CODIGO;
    
END;




--------TRIGGER POST- VENTA que capte una venta fiada y cambie el estado de un cliente
---------FALTA EXCEPTION SI EL CLIENTE YA DEBE

CREATE OR REPLACE TRIGGER venta_fiado
     AFTER INSERT ON BOLETA FOR EACH ROW
       WHEN(NEW.MEDIO_PAGO_IDMEDIO = 4)
DECLARE
BEGIN 
    UPDATE CLIENTE
    SET estado_fiado_idestado = 2
    WHERE RUNCLIENTE = :NEW.CLIENTE_RUNCLIENTE;
    
END;